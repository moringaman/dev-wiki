(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{159:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"solidity-contract-crowd-funding-example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#solidity-contract-crowd-funding-example","aria-hidden":"true"}},[t._v("#")]),t._v(" Solidity Contract - Crowd Funding Example")]),s("h4",{attrs:{id:"the-campaign-factory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#the-campaign-factory","aria-hidden":"true"}},[t._v("#")]),t._v(" The Campaign Factory")]),s("p",[t._v("Create a campaign factory which is an initial campaign which can be called by various ethereum accouns to spawn instances of the main Campaign contract.")]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\ncontract CampaignFactory "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    address"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" deployedCampaigns"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("createCampaign")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint minimum"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        address newCampaign "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Campaign")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("minimum"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" msg"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sender"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        deployedCampaigns"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("push")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newCampaign"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("getDeployedCampaigns")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" view "),s("span",{attrs:{class:"token function"}},[t._v("returns")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("address"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" deployedCampaigns"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("ol",[s("li",[s("p",[t._v("Create an address array or ("),s("strong",[t._v("array of type address")]),t._v(") to store all campaign addresses deployed by our factory.  "),s("code",[t._v("address[] public deployedCampaigns")])])]),s("li",[s("p",[t._v("Create a createCampaign function which takes a minimum contribution value as an unsigned integer ahd creates a new campaign by calling the Campaign contract and passing in the minimum amount and the account that created it as the msg.sender.")])]),s("li",[s("p",[t._v("finally add the address of the new Campaign contract to the array of deployed campaigns.")])])]),s("h4",{attrs:{id:"note"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#note","aria-hidden":"true"}},[t._v("#")]),t._v(" NOTE")]),s("p",[t._v("This campaign also has a "),s("strong",[t._v("getDeployedCampaigns")]),t._v(" function which can be used to query all contracts that it has created.")]),s("h3",{attrs:{id:"the-campaign"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#the-campaign","aria-hidden":"true"}},[t._v("#")]),t._v(" The Campaign")]),s("ol",[s("li",[t._v("First our Campaign contract is instantiated with the following campaign function which has the same name as our campaign and is executed automatically")])]),s("p",[s("code",[t._v("contract Campaign { ... }")])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("and the two parameters that are passed to it by the factory are declared as "),s("strong",[t._v("public")]),t._v(" variables")])]),s("p",[s("code",[t._v("address public manager")]),t._v(" & "),s("code",[t._v("uint public minimumContribution")])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("Next we set up our contract with the main contract function which takes our two values as follows")])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("Campaign")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint minimum"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" address creator"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        manager "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" creator"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        minimumContribution "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" minimum"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("ol",[s("li",[s("p",[t._v("This establishes the campaign manager as the creator or Ethereum account that created it as well as establishing the minimum contribution for anyone wishing to contribute to the campaign.")])]),s("li",[s("p",[t._v("Now in order to create a request we need to declare a struct (or data structure) type that we will use for each request that will be later pushed into an array of requests, see below;")])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\nstruct Request "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  string description"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  uint value"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  address recipient"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  bool complete"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  uint approvalCount"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token function"}},[t._v("mapping")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("address "),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" bool"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" approvals"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("p",[t._v("You can see from the above struct that we also have a mapping which will holds all the addresses of our approvers as a key mapped to a boolean denoting whether it has been approved by that account or not.")]),s("h3",{attrs:{id:"campaign-contributions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#campaign-contributions","aria-hidden":"true"}},[t._v("#")]),t._v(" Campaign Contributions")]),s("ol",[s("li",[t._v("In order for us to allow people to contribute to our campaign contract we need to create a "),s("strong",[t._v("Payable")]),t._v(" function called contribute. This function will chack that the amount sent or "),s("strong",[t._v("msg.value")]),t._v(" is greater than our minimumContribution.")])]),s("p",[s("code",[t._v("require(msg.value > minimumContribution)")])]),s("ol",[s("li",[t._v("We are also going to add the contributors wallet address to the list of campaign approvers ("),s("strong",[t._v("people who can approve requests")]),t._v("). To do this we need to create a mapping called approvers that maps their address to a boolian value. see below:")])]),s("p",[s("code",[t._v("mapping (address => bool) public approvers;")])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("So once we have checked that  the contribution amount is enough we will map the address to true in our approvers mappings with:")])]),s("p",[s("code",[t._v("approvers[msg.sender] = true;")])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("lastly we need to increment an approversCount variable by one to keep track of how many approvers/contributers we have with")])]),s("p",[s("code",[t._v("approversCount++")])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("   "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("contribute")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" payable "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),s("span",{attrs:{class:"token function"}},[t._v("require")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" minimumContribution"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     approvers"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("msg"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sender"),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token boolean"}},[t._v("true")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     approvalCount"),s("span",{attrs:{class:"token operator"}},[t._v("++")]),t._v("\n   "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("p",[t._v("The fact that the function is "),s("strong",[t._v("payable")]),t._v(" means that it is able to accept "),s("strong",[t._v("ether")]),t._v(" to be added to "),s("code",[t._v("this.balance")]),t._v(" or the contract balance.")]),s("h4",{attrs:{id:"requests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#requests","aria-hidden":"true"}},[t._v("#")]),t._v(" Requests")]),s("ol",{attrs:{start:"6"}},[s("li",[t._v("Before we can create a request we need to declare an empty array of our Request structure data-type called requests, we do that using the following statement;")])]),s("p",[s("code",[t._v("Request[] public requests; // our public keyword will automatically create a getter for our array")])]),s("ol",{attrs:{start:"7"}},[s("li",[t._v("Now we can use our createRequests  function which will take all our request parameters and populate a Request struct object to be pushed to our requests array.")])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("createRequest")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("string description"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uint value"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\taddress recipient"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" restricted "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  Request memory newRequest "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("Request")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    description"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" description"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    value"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" value"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    recipient"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" recipient"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    complete"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token boolean"}},[t._v("false")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    approvalCount"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token number"}},[t._v("0")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  requests"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("push")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newRequest"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("ol",[s("li",[s("p",[t._v("The above function is public so that it can called externally also we create an instance of the Request struct called newRequest as a pointer with the memory keyword. This temporary object is then pushed onto our empty array requests")])]),s("li",[s("p",[t._v("You'll also notice that the createRequest function is marked restricted. This is because we are using a modifier that ensures that only the campaign creator or manager can run it.")])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\nmodifier "),s("span",{attrs:{class:"token function"}},[t._v("restricted")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token function"}},[t._v("require")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sender "),s("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" manager"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  _"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("h4",{attrs:{id:"request-approvals"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-approvals","aria-hidden":"true"}},[t._v("#")]),t._v(" Request Approvals")]),s("ol",[s("li",[t._v("In our approveRequest function we are going to select a request by it's index from our array of Request objects (or Structs) called requests create some storage for it in order to update it's approvals membership and icrement the approval count.")])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("approveRequest")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint index"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  Request storage request "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("index"),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("ol",[s("li",[s("p",[t._v("Next we need to make sure that first the approver is one of our campaign approvers with:")]),s("p",[s("code",[t._v("require(approvers[msg.sender]); // is this a truthy value")])])]),s("li",[s("p",[t._v("We also need to make sure that they have not already approved our selected request with.")]),s("p",[s("code",[t._v("require(!request.approvals[msg.sender]); // are they in the request Structs approvals mapping?")])])]),s("li",[s("p",[t._v("Finally we need to add the sender to the request Structs approval mapping and increment the requests approval count with:")]),s("p",[s("code",[t._v("request.approvals[msg.sender] = true;")])]),s("p",[s("code",[t._v("request.approvalCount++")])])]),s("li",[s("p",[t._v("So our final function looks like:-")])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n   "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("approveRequest")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iuint index"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     Request storage request "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("index"),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{attrs:{class:"token function"}},[t._v("require")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("approvers"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("msg"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sender"),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{attrs:{class:"token function"}},[t._v("require")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token operator"}},[t._v("!")]),t._v("requests"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("approvals"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("msg"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sender"),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     \n     requests"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("approvals"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("msg"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sender"),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token boolean"}},[t._v("true")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     requests"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("approvalCount"),s("span",{attrs:{class:"token operator"}},[t._v("++")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"finalizing-requests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#finalizing-requests","aria-hidden":"true"}},[t._v("#")]),t._v(" Finalizing Requests")]),s("ol",[s("li",[s("p",[t._v("In order to finalize a request which results in the funds being sent to the suppliers wallet we first create a public function which utilizes the\nrestricted modifier and accepts the index of the request to be finalized.")])]),s("li",[s("p",[t._v("Next we need to create a place in memory called request and set it equal to requests array at the index provided")])]),s("li",[s("p",[t._v("Thirdly we need to check that most of our approvers have given their approval this is done by checking that our approcal count is"),s("br"),t._v("\ngreater that half of approversCount. We also make sure that the request has not already been completed.")])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("finalizeRequest")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint index"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" restricted "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Request storage request "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("index"),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{attrs:{class:"token function"}},[t._v("require")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("approvalCount "),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("approversCount "),s("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{attrs:{class:"token number"}},[t._v("2")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token function"}},[t._v("require")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token operator"}},[t._v("!")]),t._v("request"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("complete"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        request"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recipient"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("transfer")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        request"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("complete "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token boolean"}},[t._v("true")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n \n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("finally we transfer the value to the requests recipient and mark the request as completed.")])])])}],!1,null,null,null);a.default=e.exports}}]);