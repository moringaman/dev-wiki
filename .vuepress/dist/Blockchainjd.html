<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>BlockChainjs | Dev Docs</title>
    <meta name="description" content="Webnostix Dev Wiki">
    
    
    <link rel="preload" href="/assets/css/0.styles.fba42894.css" as="style"><link rel="preload" href="/assets/js/app.cc40a5f5.js" as="script"><link rel="preload" href="/assets/js/16.30646442.js" as="script"><link rel="prefetch" href="/assets/js/9.0ec6c30b.js"><link rel="prefetch" href="/assets/js/1.6e8899c0.js"><link rel="prefetch" href="/assets/js/2.bae8b180.js"><link rel="prefetch" href="/assets/js/3.d2b68578.js"><link rel="prefetch" href="/assets/js/4.44d7cdba.js"><link rel="prefetch" href="/assets/js/5.073a3f86.js"><link rel="prefetch" href="/assets/js/6.d84e31e5.js"><link rel="prefetch" href="/assets/js/7.c074d7aa.js"><link rel="prefetch" href="/assets/js/8.9a61caa9.js"><link rel="prefetch" href="/assets/js/10.ee871895.js"><link rel="prefetch" href="/assets/js/11.52f491ba.js"><link rel="prefetch" href="/assets/js/12.3ee5cad0.js"><link rel="prefetch" href="/assets/js/13.c8b0f402.js"><link rel="prefetch" href="/assets/js/14.e3744b19.js"><link rel="prefetch" href="/assets/js/15.ebe9d38c.js"><link rel="prefetch" href="/assets/js/17.80aba5f3.js"><link rel="prefetch" href="/assets/js/18.7c824585.js"><link rel="prefetch" href="/assets/js/19.25524343.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fba42894.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Dev Docs
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/Javascript.html" class="nav-link">Javascript</a></div><div class="nav-item"><a href="/Dev-Ops.html" class="nav-link">Dev-Ops</a></div><div class="nav-item"><a href="/Blockchain.html" class="nav-link">BlockChain</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/Javascript.html" class="nav-link">Javascript</a></div><div class="nav-item"><a href="/Dev-Ops.html" class="nav-link">Dev-Ops</a></div><div class="nav-item"><a href="/Blockchain.html" class="nav-link">BlockChain</a></div><!----></nav><!----></div><div class="page"><div class="content"><h1 id="blockchainjs"><a href="#blockchainjs" aria-hidden="true" class="header-anchor">#</a> BlockChainjs</h1><h2 id="how-to-code-a-blockchain-in-javascript"><a href="#how-to-code-a-blockchain-in-javascript" aria-hidden="true" class="header-anchor">#</a> How to code a blockchain in javascript</h2><h3 id="our-blockchain-class"><a href="#our-blockchain-class" aria-hidden="true" class="header-anchor">#</a> Our Blockchain class</h3><p>We will code out our javascript blockchain as a class called Blockchain with an initial constructor
which specifies two arrays. The first will contain our blocks and the other pending transactions until they are added to new blocks a they are mined.</p><div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">class</span> <span class="token class-name">Blockchain</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>chain <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// to contain an array of blocks</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>pendingTransactions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="the-createnewblock-function"><a href="#the-createnewblock-function" aria-hidden="true" class="header-anchor">#</a> The createNewBlock function</h3><p>In order to create our first block we need to create a function which inherits our blockchain classes methods and properties to do this we use prototypes.</p><div class="language-js extra-class"><pre class="language-js"><code>Blockchain<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">createNewBlock</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>nonce<span class="token punctuation">,</span> previousBlockHash<span class="token punctuation">,</span> hash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> newBlock <span class="token operator">=</span> <span class="token punctuation">{</span>
		index<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>chain<span class="token punctuation">.</span>lenght <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
		timestamp<span class="token punctuation">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		transactions<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pendingTransactions<span class="token punctuation">,</span>
		nonce<span class="token punctuation">:</span> nonce<span class="token punctuation">,</span>
		hash<span class="token punctuation">:</span> hash<span class="token punctuation">,</span>
		previousHash<span class="token punctuation">:</span> previousBlockHash
	<span class="token punctuation">}</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>pendingTransactions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>chain<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newBlock<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">return</span> newBlock<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Our newBlock object contains all the information we need for each block some refer to our previous block and the transactions contained in our block are taken from the pendingtransactions array. We then empty the pending transactions and push our new block onto our chain (array of block objects)</p><p>creatNew block takes three variables nonce, hash and previousBlockHash</p><h3 id="the-getlastblock-function"><a href="#the-getlastblock-function" aria-hidden="true" class="header-anchor">#</a> The getLastBlock function</h3><p>In order to privide our createNewBlock function with the previous blocks hash we need to get the previous block in our chain array/
this would be the last index - 1 (see code below)</p><div class="language-js extra-class"><pre class="language-js"><code>Blockchain<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getLastBlock</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>chain<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>chain<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="creating-new-transactions"><a href="#creating-new-transactions" aria-hidden="true" class="header-anchor">#</a> Creating New Transactions</h3><p>We also need a way to create new transactions which can record funds transfers from one wallet to another/
this function will then be pushed onto the pendingTransactions array of our chain prior to being mined/
and placed into the transactions array of a newBlocks.</p><div class="language-js extra-class"><pre class="language-js"><code>Blockchain<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">createNewTransaction</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>amount<span class="token punctuation">,</span> sender<span class="token punctuation">,</span> recipient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> newTransaction <span class="token operator">=</span> <span class="token punctuation">{</span>
		amount<span class="token punctuation">:</span> amount<span class="token punctuation">,</span>
		sender<span class="token punctuation">:</span> sender<span class="token punctuation">,</span>
		recipient<span class="token punctuation">:</span> recipient
	<span class="token punctuation">}</span>
	
	<span class="token keyword">this</span><span class="token punctuation">.</span>chain<span class="token punctuation">.</span>pendingTransactions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newTransaction<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLastBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>we also call getLastBlock to find the lastblock index and then add 1 to it so that we can report back the/
block number or (index) of where the transction will be created.</p><h2 id="hashing-and-proof-of-work"><a href="#hashing-and-proof-of-work" aria-hidden="true" class="header-anchor">#</a> Hashing and Proof of Work</h2><h3 id="hashing-with-sha256-encryption"><a href="#hashing-with-sha256-encryption" aria-hidden="true" class="header-anchor">#</a> Hashing with sha256 Encryption</h3><p>In order to encrypt our blockchain in order to prevent it from being hacked and altered we will be hashing each of our blocks as well as running a proof of work/
algorithm in order to prove it's data integrity. First we introduce the hasBlock function which simply takes in three params concatinates them into a string/
and then hashes the result.</p><p>Our 3 parameters are previousBlockHash, currentBlockData and nonce..</p><div class="language-js extra-class"><pre class="language-js"><code>Blockchain<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">hashBlock</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>previousBlockHash<span class="token punctuation">,</span> currentBlockData<span class="token punctuation">,</span> nonce<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> blockData <span class="token operator">=</span> previousBlockHash <span class="token operator">+</span> nonce<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>currentBlockData<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> hash <span class="token operator">=</span> <span class="token function">sha256</span><span class="token punctuation">(</span>blockData<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> hash<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="the-proofofwork-function"><a href="#the-proofofwork-function" aria-hidden="true" class="header-anchor">#</a> The proofOfWork() Function</h3><p>We now need to create a way to ensure the integrity of our blockchain, now to do this we are going to try to always generate a hash value begging with 0000/
Givern that we already know what our hashBlock method requires to create a hash we need to generate a nonce which will result in a correct hash given the
prevousBlockHash and currentBlockData, which cannot be changed.</p><p>We have to do this through trial and error passing our currentBlockData and previousBlockHash to sha256 whilst at the same time incrementing our nonce value from/
0 upwards until the resulting hash starts with 0000. To do this we will use a simple while loop.</p><div class="language-js extra-class"><pre class="language-js"><code>Blockchain<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">proofOfWork</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>previousBlockHash<span class="token punctuation">,</span> currentBlockData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> nonce <span class="token operator">=</span> <span class="token number">0</span>
	<span class="token keyword">let</span> hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hashBlock</span><span class="token punctuation">(</span>previousBlockHash<span class="token punctuation">,</span> currentBlockData<span class="token punctuation">,</span> nonce<span class="token punctuation">)</span> 
	<span class="token keyword">while</span> <span class="token punctuation">(</span>hash<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">&quot;0000&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	nonce<span class="token operator">++</span>
	hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hashBlock</span><span class="token punctuation">(</span>previousBlockHash<span class="token punctuation">,</span> currentBlockData<span class="token punctuation">,</span> nonce<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">return</span> nonce<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Finally we return our nonce value as this is what we will use whenever we hash a new block as part of out mining process.</p></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/assets/js/16.30646442.js" defer></script><script src="/assets/js/app.cc40a5f5.js" defer></script>
  </body>
</html>
